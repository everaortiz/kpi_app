
import functools

def check_connection(func):
    """checks the SQL client connection and reconnects, if necessary"""
    @functools.wraps(func)
    def wrapper(cls, *args, **kwargs):
        if not hasattr(cls, 'connection') or cls.is_connection_closed():
            cls.reconnect()
        return func(cls, *args, **kwargs)
    return wrapper

def close_current_cursor(func):
    @functools.wraps(func)
    def wrapper(cls, *args, **kwargs):
        try:
            cls.cursor.close()
        except:
            pass
        return func(cls, *args, **kwargs)
    return wrapper