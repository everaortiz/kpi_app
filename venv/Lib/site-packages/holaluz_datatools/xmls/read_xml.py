import xmltodict
from collections import OrderedDict

def OrderedDict_to_dict(arg):
    """recursive function to convert a nested OrderedDict into a dict"""
    if isinstance(arg, (tuple, list)):
        return [OrderedDict_to_dict(item) for item in arg]
    if isinstance(arg, OrderedDict):
        arg = dict(arg)
    if isinstance(arg, dict):
        for key, value in arg.items():
            arg[key] = OrderedDict_to_dict(value)
            
    return arg

def read_xml(xml_fp):
    """reads the XML file `xml_fp` and returns it as a nested dictionary"""  
    with open(xml_fp, mode = 'r', encoding = 'utf-8', errors = 'ignore') as fin:
        doc = xmltodict.parse(fin.read())
        
    return OrderedDict_to_dict(doc)

